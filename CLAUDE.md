# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Repository Overview

This repository contains a distant reading analysis project for two Project Gutenberg eBooks related to plant folklore and botanical history, presented through a Victorian garden-themed web interface.

### Source Texts

1. **Plant Lore Legends and Lyrics Text File.txt** (1.8MB, 35,133 lines)
   - Author: Richard Folkard, Jun. (1884)
   - Content: Myths, traditions, superstitions, and folklore of the plant kingdom
   - Includes both Continental and Indian plant lore

2. **Plant Lore and Garden Craft of Shakespeare.txt** (918KB, 25,705 lines)
   - Author: Henry Nicholson Ellacombe
   - Content: Analysis of plants mentioned in Shakespeare's works
   - Combines literary history with botanical knowledge

Both files are UTF-8 encoded with BOM, CRLF line endings, and public domain content from Project Gutenberg.

## Architecture

### Analysis Pipeline (`analyze_texts.py`)

Python script that performs distant reading analysis:
- **Text Preprocessing**: Strips Project Gutenberg metadata, tokenizes, removes stopwords
- **Bag of Words**: Generates word frequency distributions using NLTK
- **Sentiment Analysis**: Uses VADER to analyze sentiment across entire texts
- **Word Clouds**: Generates visual representations with Victorian botanical color palettes
- **Comparative Analysis**: Calculates vocabulary overlap and unique words between texts
- **Output**: Creates `analysis.json` with all metrics and two word cloud PNG files

Key class: `TextAnalyzer` handles all text processing and analysis for a single text.

### Web Interface

Victorian garden-themed responsive interface:
- **index.html**: Three-view structure (Folkard, Shakespeare, Comparison)
- **styles.css**: Victorian botanical design with sage green, dusty rose, cream, burgundy colors
- **app.js**: Loads `analysis.json`, populates views, creates D3.js Venn diagram

The interface displays:
- Textual statistics (total words, unique words, lexical diversity)
- Sentiment analysis bars (positive, negative, neutral, compound)
- Word clouds (static PNG images)
- Top 30 most common words per text
- Vocabulary overlap visualization using D3.js

### Generated Files

Analysis outputs (not committed, generated by running analysis):
- `analysis.json`: Complete analysis data structure
- `wordcloud_folkard.png`: Word cloud for Folkard text
- `wordcloud_shakespeare.png`: Word cloud for Shakespeare text

## Common Commands

### Running the Analysis

```bash
# Install Python dependencies
pip install -r requirements.txt

# Run complete analysis (takes ~10-15 minutes on large texts)
python3 analyze_texts.py
```

The analysis script will:
1. Download required NLTK data automatically
2. Process both texts
3. Generate word clouds with Victorian color schemes
4. Create analysis.json with all results
5. Print progress and final statistics

### Viewing the Interface

Open `index.html` in a web browser. No build step required - the interface uses CDN for D3.js.

## Data Flow

```
Text Files (*.txt)
    ↓
analyze_texts.py (TextAnalyzer class)
    ↓
analysis.json + wordcloud_*.png
    ↓
index.html (loads via fetch)
    ↓
app.js (populates DOM, creates D3 viz)
```

## Working with the Texts

When modifying the analysis:
- Both source texts are large; preprocessing takes several minutes
- VADER sentiment analysis is slow on texts >500KB (6-8 minutes per text)
- Word cloud generation uses matplotlib with 'Agg' backend (no display required)
- The `TextAnalyzer.strip_gutenberg_metadata()` method uses regex to find START/END markers
- Historical spellings and formatting preserved: Greek text between +plus signs+, italics between _underscores_

## Victorian Garden Design System

The interface uses a consistent design language:
- **Fonts**: Cinzel (display/headings), Crimson Text (body)
- **Colors**: CSS variables in `:root` for sage-green, dusty-rose, cream, burgundy, gold-accent, moss
- **Ornamental elements**: Double borders, floral flourishes (❦, ◈), parchment texture background
- **Responsive**: Grid layouts adapt to mobile with media queries at 768px breakpoint

## Analysis Results Structure

The `analysis.json` contains:
- `texts[]`: Array with two objects (Folkard, Shakespeare)
  - `total_words`, `unique_words`, `lexical_diversity`
  - `sentiment`: {positive, negative, neutral, compound}
  - `top_words[]`: Array of {word, count} objects
  - `bag_of_words`: Dictionary of top 500 words with frequencies
- `comparison`:
  - `total_shared_words`, `unique_to_folkard`, `unique_to_shakespeare`
  - `overlap_percentage`
  - `top_shared_words[]`: Shared vocabulary by combined frequency
  - `top_unique_folkard[]`, `top_unique_shakespeare[]`: Sample unique words
- `metadata`: Analysis type, methods used, file paths

## Extending the Analysis

To add new analysis features:
1. Add methods to `TextAnalyzer` class in `analyze_texts.py`
2. Update `to_dict()` method to include new metrics in output
3. Add corresponding display elements to `index.html`
4. Update `app.js` to populate new sections from `analysis.json`
5. Style new elements in `styles.css` using Victorian design tokens

To analyze different texts:
- Modify the `main()` function in `analyze_texts.py`
- Update file paths, titles, and authors
- Ensure texts follow Project Gutenberg format with START/END markers
